@page
@model BSMS.WebApp.Pages.Admin.Reports.IndexModel

<h2>Báo cáo doanh thu</h2>

<form method="get">
    <input type="date" name="StartDate" value="@Model.StartDate:yyyy-MM-dd" />
    <input type="date" name="EndDate" value="@Model.EndDate:yyyy-MM-dd" />
    <button type="submit" class="btn btn-info">Xem</button>
    <button type="submit" asp-page-handler="Export" class="btn btn-success">Xuất Excel</button>
</form>

<div class="mt-3">
    <h4>Tổng doanh thu: @Model.TotalRevenue.ToString("N0")đ</h4>
</div>

<canvas id="revenueChart" height="100"></canvas>

@section Scripts {
    <script src="~/lib/chart.js/Chart.min.js"></script>
    <script>
        const ctx = document.getElementById('revenueChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: [@string.Join(",", Model.DailyData.Select(d => $"'{d.Date:dd/MM}'"))],
                datasets: [{
                    label: 'Doanh thu (đ)',
                    data: [@string.Join(",", Model.DailyData.Select(d => d.Revenue))],
                    borderColor: 'rgb(75, 192, 192)',
                    tension: 0.1
                }]
            }
        });
    </script>
}
